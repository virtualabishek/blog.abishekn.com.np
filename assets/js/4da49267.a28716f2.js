"use strict";(self.webpackChunkblog_site=self.webpackChunkblog_site||[]).push([[392],{4222:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});var t=s(6102),r=s(4848),i=s(8453);const a={slug:"jwt-access-token-refresh-token-in-nestjs-ecommerce",title:"Secure Authentication in NestJS E-Commerce: JWT, Access Tokens, and Refresh Tokens Explained",authors:["virtualabishek"],date:"2025-12-29",description:"A practical guide to implementing secure JWT-based authentication with access tokens and refresh tokens in a NestJS e-commerce project. Covers token generation, validation, refresh flow, security best practices, and real-world application in an online store.",tags:["technical","nestjs","javascript","authentication","jwt","security","ecommerce","backend"]},o="JWT, Access Tokens & Refresh Tokens Explained",c={authorsImageUrls:[void 0]},l=[{value:"1. What is JWT (JSON Web Token)?",id:"1-what-is-jwt-json-web-token",level:2},{value:"JWT Structure",id:"jwt-structure",level:3},{value:"Part 1: Header",id:"part-1-header",level:3},{value:"Part 2: Payload (Claims)",id:"part-2-payload-claims",level:3},{value:"Part 3: Signature",id:"part-3-signature",level:3},{value:"2. Access Token vs Refresh Token",id:"2-access-token-vs-refresh-token",level:2},{value:"Why Two Tokens?",id:"why-two-tokens",level:3},{value:"3. The Complete Authentication Flow",id:"3-the-complete-authentication-flow",level:2},{value:"4. Making Authenticated Requests",id:"4-making-authenticated-requests",level:2},{value:"5. Token Refresh Flow (When Access Token Expires)",id:"5-token-refresh-flow-when-access-token-expires",level:2},{value:"6. How It&#39;s Implemented in Your Codebase",id:"6-how-its-implemented-in-your-codebase",level:2},{value:"Backend (NestJS)",id:"backend-nestjs",level:3},{value:"Frontend (React/Next.js)",id:"frontend-reactnextjs",level:3},{value:"7. The Relationship Diagram",id:"7-the-relationship-diagram",level:2},{value:"8. Security Best Practices",id:"8-security-best-practices",level:2},{value:"9. Common Questions",id:"9-common-questions",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"1-what-is-jwt-json-web-token",children:"1. What is JWT (JSON Web Token)?"}),"\n",(0,r.jsx)(n.p,{children:"JWT is a compact, self-contained way to securely transmit information between parties as a JSON object. It's digitally signed, so it can be verified and trusted."}),"\n",(0,r.jsx)(n.h3,{id:"jwt-structure",children:"JWT Structure"}),"\n",(0,r.jsx)(n.p,{children:"A JWT looks like this:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4ifQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n"})}),"\n",(0,r.jsxs)(n.p,{children:["It has ",(0,r.jsx)(n.strong,{children:"3 parts"})," separated by dots (",(0,r.jsx)(n.code,{children:"."}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"HEADER.PAYLOAD.SIGNATURE\n"})}),"\n",(0,r.jsx)(n.h3,{id:"part-1-header",children:"Part 1: Header"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "HS256",    // Algorithm used to sign (HMAC SHA256)\n  "typ": "JWT"       // Type of token\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["This is Base64Url encoded \u2192 ",(0,r.jsx)(n.code,{children:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"})]}),"\n",(0,r.jsx)(n.h3,{id:"part-2-payload-claims",children:"Part 2: Payload (Claims)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "82919d9f-7c7c-4e82-a613-3ce0b7bc523b",  // Subject (user ID)\n  "email": "user@example.com",\n  "role": "seller",\n  "iat": 1766993470,    // Issued At (timestamp)\n  "exp": 1766994370     // Expiration (timestamp)\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["This is Base64Url encoded \u2192 ",(0,r.jsx)(n.code,{children:"eyJzdWIiOiI4MjkxOWQ5Zi03..."})]}),"\n",(0,r.jsx)(n.h3,{id:"part-3-signature",children:"Part 3: Signature"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'HMACSHA256(\n  base64UrlEncode(header) + "." + base64UrlEncode(payload),\n  "your-super-secret-jwt-key"  // Your JWT_SECRET from .env\n)\n'})}),"\n",(0,r.jsx)(n.p,{children:"This creates a signature that verifies the token wasn't tampered with."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-access-token-vs-refresh-token",children:"2. Access Token vs Refresh Token"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"Access Token"}),(0,r.jsx)(n.th,{children:"Refresh Token"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Purpose"})}),(0,r.jsx)(n.td,{children:"Authenticate API requests"}),(0,r.jsx)(n.td,{children:"Get new access tokens"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Lifespan"})}),(0,r.jsx)(n.td,{children:"Short (15 min - 1 hour)"}),(0,r.jsx)(n.td,{children:"Long (7 days - 30 days)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Stored in"})}),(0,r.jsx)(n.td,{children:"Memory / localStorage"}),(0,r.jsx)(n.td,{children:"localStorage / httpOnly cookie"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sent with"})}),(0,r.jsx)(n.td,{children:"Every API request"}),(0,r.jsxs)(n.td,{children:["Only to ",(0,r.jsx)(n.code,{children:"/auth/refresh"})," endpoint"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"If stolen"})}),(0,r.jsx)(n.td,{children:"Limited damage (expires soon)"}),(0,r.jsx)(n.td,{children:"More dangerous (can get new tokens)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"why-two-tokens",children:"Why Two Tokens?"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security vs User Experience tradeoff:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"If we only had long-lived tokens:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User stays logged in for weeks \u2705"}),"\n",(0,r.jsx)(n.li,{children:"But if stolen, attacker has access for weeks \u274c"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"If we only had short-lived tokens:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If stolen, attacker only has 15 minutes \u2705"}),"\n",(0,r.jsx)(n.li,{children:"But user must re-login every 15 minutes \u274c"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"With Access + Refresh tokens:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Access token expires quickly (15 min) - limits damage if stolen \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Refresh token gets new access tokens - user stays logged in \u2705"}),"\n",(0,r.jsx)(n.li,{children:"Refresh token is only sent to ONE endpoint - smaller attack surface \u2705"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-the-complete-authentication-flow",children:"3. The Complete Authentication Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           AUTHENTICATION FLOW                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Browser \u2502                    \u2502  Backend \u2502                    \u2502 Database \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                               \u2502                               \u2502\n     \u2502  1. POST /auth/login          \u2502                               \u2502\n     \u2502  { email, password }          \u2502                               \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                               \u2502\n     \u2502                               \u2502  2. Verify password           \u2502\n     \u2502                               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                               \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  3. Generate tokens:          \u2502\n     \u2502                               \u2502     - Access (15min)          \u2502\n     \u2502                               \u2502     - Refresh (7 days)        \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  4. Store refresh token       \u2502\n     \u2502                               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                               \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  5. Return both tokens        \u2502                               \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  6. Store in localStorage:    \u2502                               \u2502\n     \u2502     auth_access_token         \u2502                               \u2502\n     \u2502     auth_refresh_token        \u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-making-authenticated-requests",children:"4. Making Authenticated Requests"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Browser \u2502                    \u2502  Backend \u2502                    \u2502 Database \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                               \u2502                               \u2502\n     \u2502  GET /api/products            \u2502                               \u2502\n     \u2502  Header: Authorization:       \u2502                               \u2502\n     \u2502  Bearer eyJhbGci...           \u2502                               \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  1. Extract token from header \u2502\n     \u2502                               \u2502  2. Verify signature with     \u2502\n     \u2502                               \u2502     JWT_SECRET                \u2502\n     \u2502                               \u2502  3. Check expiration          \u2502\n     \u2502                               \u2502  4. Extract user info         \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  If valid:                    \u2502\n     \u2502  \u2705 Return products           \u2502  Get products for user        \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  If expired/invalid:          \u2502\n     \u2502  \u274c 401 Unauthorized          \u2502                               \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-token-refresh-flow-when-access-token-expires",children:"5. Token Refresh Flow (When Access Token Expires)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Browser \u2502                    \u2502  Backend \u2502                    \u2502 Database \u2502\n\u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518                    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n     \u2502                               \u2502                               \u2502\n     \u2502  GET /api/categories          \u2502                               \u2502\n     \u2502  Bearer: [expired token]      \u2502                               \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  \u274c 401 Unauthorized          \u2502  Token expired!               \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502                               \u2502\n     \u2502  \u2502 Axios Interceptor       \u2502  \u2502                               \u2502\n     \u2502  \u2502 catches 401, tries      \u2502  \u2502                               \u2502\n     \u2502  \u2502 to refresh              \u2502  \u2502                               \u2502\n     \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  POST /auth/refresh           \u2502                               \u2502\n     \u2502  { refreshToken: "eyJ..." }   \u2502                               \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                               \u2502\n     \u2502                               \u2502  1. Find token in database    \u2502\n     \u2502                               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                               \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n     \u2502                               \u2502                               \u2502\n     \u2502                               \u2502  2. Verify not expired        \u2502\n     \u2502                               \u2502  3. Verify JWT signature      \u2502\n     \u2502                               \u2502  4. Generate NEW tokens       \u2502\n     \u2502                               \u2502  5. Delete OLD refresh token  \u2502\n     \u2502                               \u2502  6. Store NEW refresh token   \u2502\n     \u2502                               \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  Return new tokens            \u2502                               \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  Store new tokens in          \u2502                               \u2502\n     \u2502  localStorage                 \u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  RETRY original request       \u2502                               \u2502\n     \u2502  GET /api/categories          \u2502                               \u2502\n     \u2502  Bearer: [NEW access token]   \u2502                               \u2502\n     \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n     \u2502  \u2705 Return categories         \u2502                               \u2502\n     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                               \u2502\n     \u2502                               \u2502                               \u2502\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-how-its-implemented-in-your-codebase",children:"6. How It's Implemented in Your Codebase"}),"\n",(0,r.jsx)(n.h3,{id:"backend-nestjs",children:"Backend (NestJS)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. Generating Tokens"})," - auth.service.ts"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"async generateTokens(user: any) {\n  const payload = {\n    sub: user.id,           // Subject - who this token is for\n    email: user.email,\n    username: user.username,\n    role: user.role,\n  };\n\n  // Access token - short lived (15 minutes)\n  const accessToken = this.jwtService.sign(payload, {\n    expiresIn: '15m',\n  });\n\n  // Refresh token - long lived (7 days)\n  const refreshToken = this.jwtService.sign(payload, {\n    expiresIn: '7d',\n  });\n\n  // Store refresh token in database (so we can invalidate it)\n  await this.prisma.refreshToken.create({\n    data: {\n      token: refreshToken,\n      userId: user.id,\n      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\n    },\n  });\n\n  return { accessToken, refreshToken, expiresIn: 900 };\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. JWT Guard"})," - Protects routes"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// jwt-auth.guard.ts\n@Injectable()\nexport class JwtAuthGuard extends AuthGuard('jwt') {\n  canActivate(context: ExecutionContext) {\n    // Check if route is marked @Public()\n    const isPublic = this.reflector.get(IS_PUBLIC_KEY, context.getHandler());\n    if (isPublic) return true;  // Skip auth for public routes\n    \n    return super.canActivate(context);  // Verify JWT\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. JWT Strategy"})," - Validates tokens"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"// jwt.strategy.ts\n@Injectable()\nexport class JwtStrategy extends PassportStrategy(Strategy) {\n  constructor() {\n    super({\n      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n      secretOrKey: process.env.JWT_SECRET,  // Same secret used to sign\n    });\n  }\n\n  // Called after JWT is verified\n  async validate(payload: any) {\n    return {\n      userId: payload.sub,\n      email: payload.email,\n      role: payload.role,\n    };\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"frontend-reactnextjs",children:"Frontend (React/Next.js)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"1. Storing Tokens After Login"})," - authSlice.ts"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const response = await authService.login(email, password);\n\n// Store both tokens in localStorage\ntokenManager.setTokens(response.accessToken, response.refreshToken);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"2. Attaching Token to Every Request"})," - axios-instance.ts"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"axiosInstance.interceptors.request.use((config) => {\n  const token = tokenManager.getAccessToken();\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"3. Auto-Refresh on 401"})," - axios-instance.ts"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"axiosInstance.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      \n      const refreshToken = tokenManager.getRefreshToken();\n      \n      // Get new tokens\n      const response = await axios.post('/auth/refresh', { refreshToken });\n      \n      // Store new tokens\n      tokenManager.setTokens(response.accessToken, response.refreshToken);\n      \n      // Retry the failed request with new token\n      return axiosInstance(originalRequest);\n    }\n  }\n);\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-the-relationship-diagram",children:"7. The Relationship Diagram"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                              JWT ECOSYSTEM                                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                              \u2502   JWT_SECRET    \u2502\n                              \u2502 (in .env file)  \u2502\n                              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                       \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502                  \u2502                  \u2502\n                    \u25bc                  \u25bc                  \u25bc\n           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n           \u2502  Sign Tokens   \u2502 \u2502 Verify Tokens  \u2502 \u2502 Decode Tokens  \u2502\n           \u2502  (on login)    \u2502 \u2502 (on requests)  \u2502 \u2502 (get payload)  \u2502\n           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                    \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u25bc                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 ACCESS TOKEN  \u2502       \u2502 REFRESH TOKEN \u2502\n\u2502  (15 minutes) \u2502       \u2502   (7 days)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502                       \u2502\n        \u2502                       \u2502\n        \u25bc                       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    localStorage   \u2502   \u2502    localStorage   \u2502\n\u2502 auth_access_token \u2502   \u2502 auth_refresh_token\u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                  \u2502\n                                  \u25bc\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502     DATABASE      \u2502\n                        \u2502  RefreshToken     \u2502\n                        \u2502  table (for       \u2502\n                        \u2502  invalidation)    \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           REQUEST LIFECYCLE                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n  User Action          Frontend                    Backend                  DB\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502  Click "Create"   \u2502                          \u2502                      \u2502\n      \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                          \u2502                      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502  1. Get access token     \u2502                      \u2502\n      \u2502                   \u2502     from localStorage    \u2502                      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502  2. Add to header:       \u2502                      \u2502\n      \u2502                   \u2502     Authorization:       \u2502                      \u2502\n      \u2502                   \u2502     Bearer eyJ...        \u2502                      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502  POST /api/categories    \u2502                      \u2502\n      \u2502                   \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502                          \u2502  3. JwtAuthGuard     \u2502\n      \u2502                   \u2502                          \u2502     - Extract token  \u2502\n      \u2502                   \u2502                          \u2502     - Verify with    \u2502\n      \u2502                   \u2502                          \u2502       JWT_SECRET     \u2502\n      \u2502                   \u2502                          \u2502     - Check exp      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502                          \u2502  4. @CurrentUser()   \u2502\n      \u2502                   \u2502                          \u2502     - Get user from  \u2502\n      \u2502                   \u2502                          \u2502       token payload  \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502                          \u2502  5. Create category  \u2502\n      \u2502                   \u2502                          \u2502\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n      \u2502                   \u2502                          \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n      \u2502                   \u2502  \u2705 201 Created          \u2502                      \u2502\n      \u2502  Show success     \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                      \u2502\n      \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502                          \u2502                      \u2502\n      \u2502                   \u2502                          \u2502                      \u2502\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-security-best-practices",children:"8. Security Best Practices"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Practice"}),(0,r.jsx)(n.th,{children:"Why"}),(0,r.jsx)(n.th,{children:"Your Code"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Short access token expiry"})}),(0,r.jsx)(n.td,{children:"Limits damage if stolen"}),(0,r.jsx)(n.td,{children:"\u2705 15 minutes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Store refresh token in DB"})}),(0,r.jsx)(n.td,{children:"Can invalidate on logout"}),(0,r.jsx)(n.td,{children:"\u2705 RefreshToken table"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Rotate refresh tokens"})}),(0,r.jsx)(n.td,{children:"Old tokens become invalid"}),(0,r.jsx)(n.td,{children:"\u2705 Delete old, create new"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Use HTTPS"})}),(0,r.jsx)(n.td,{children:"Prevents token interception"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Use in production"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"HttpOnly cookies"})}),(0,r.jsx)(n.td,{children:"Prevents XSS theft"}),(0,r.jsx)(n.td,{children:"\u274c Using localStorage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Strong JWT_SECRET"})}),(0,r.jsx)(n.td,{children:"Prevents token forgery"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Change in production"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-common-questions",children:"9. Common Questions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Q: Why store refresh token in database?"}),"\nA: So you can invalidate it on logout. Without DB storage, the token is valid until expiration."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Q: Can I decode a JWT without the secret?"}),"\nA: Yes! The payload is just Base64 encoded. But you can't ",(0,r.jsx)(n.strong,{children:"verify"})," it without the secret."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Q: What happens if someone steals my refresh token?"}),"\nA: They can get new access tokens until you logout (which deletes the refresh token from DB)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Q: Why not just use sessions?"}),"\nA: JWTs are stateless - server doesn't need to store session data. Better for scaling and microservices."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},6102:e=>{e.exports=JSON.parse('{"permalink":"/blog/jwt-access-token-refresh-token-in-nestjs-ecommerce","source":"@site/blog/2025-12-28-jwt-and-token.md","title":"Secure Authentication in NestJS E-Commerce: JWT, Access Tokens, and Refresh Tokens Explained","description":"A practical guide to implementing secure JWT-based authentication with access tokens and refresh tokens in a NestJS e-commerce project. Covers token generation, validation, refresh flow, security best practices, and real-world application in an online store.","date":"2025-12-29T00:00:00.000Z","tags":[{"inline":false,"label":"Technical","permalink":"/blog/tags/blog/tags/technical","description":"You can find all technical related blogs here."},{"inline":false,"label":"NestJS","permalink":"/blog/tags/blog/tags/nestjs","description":"NestJS framework tutorials and guides."},{"inline":false,"label":"JavaScript","permalink":"/blog/tags/blog/tags/javascript","description":"JavaScript programming posts."},{"inline":false,"label":"Authentication","permalink":"/blog/tags/blog/tags/authentication","description":"Authentication and authorization topics."},{"inline":false,"label":"JWT","permalink":"/blog/tags/blog/tags/jwt","description":"JSON Web Token related posts."},{"inline":false,"label":"Security","permalink":"/blog/tags/blog/tags/security","description":"Security best practices and concepts."},{"inline":false,"label":"E-Commerce","permalink":"/blog/tags/blog/tags/ecommerce","description":"E-commerce development projects."},{"inline":false,"label":"Backend","permalink":"/blog/tags/blog/tags/backend","description":"Backend development posts."}],"readingTime":8.25,"hasTruncateMarker":false,"authors":[{"name":"Abishek Neupane","title":"Self Learner","url":"https://github.com/virtualabishek","page":{"permalink":"/blog/authors/virtualabishek"},"socials":{"github":"https://github.com/virtualabishek","linkedin":"https://www.linkedin.com/in/virtualabishek/","twitter":"https://twitter.com/virtualabishek"},"imageURL":"https://github.com/virtualabishek.png","key":"virtualabishek"}],"frontMatter":{"slug":"jwt-access-token-refresh-token-in-nestjs-ecommerce","title":"Secure Authentication in NestJS E-Commerce: JWT, Access Tokens, and Refresh Tokens Explained","authors":["virtualabishek"],"date":"2025-12-29","description":"A practical guide to implementing secure JWT-based authentication with access tokens and refresh tokens in a NestJS e-commerce project. Covers token generation, validation, refresh flow, security best practices, and real-world application in an online store.","tags":["technical","nestjs","javascript","authentication","jwt","security","ecommerce","backend"]},"unlisted":false,"prevItem":{"title":"eSewa vs Khalti: how I keep Nepali payments honest","permalink":"/blog/esewa-vs-khalti-secure-payment-flow-nepal"},"nextItem":{"title":"Spanner - Google solution for distributed database in easier","permalink":"/blog/how-google-use-spanner-for-distributed-database-management"}}')},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);